Урок 4. Мониторинг и анализ сетевого трафика

Составить фильтр для захвата при помощи tshark всего не icmp трафика, Запустить захват на всех интерфейсах командой с сохранением в файл hw1.pcap. Открыть произвольный сайт.
Составить фильтр для захвата при помощи tshark только пакетов отправленным на хост ya.ru, Запустить захват c дополнительным ключем -V на всех интерфейсах командой с сохранением в файл hw2.pcap. Открыть сайт ya.ru.
Составить фильтр для захвата при помощи tshark только пакетов, отправленным на порт 22, Запустить захват на всех интерфейсах командой с сохранением в файл hw3.pcap. Подключиться к машине по ssh.

В качестве решения приложить:
— для каждого пункта скрин, на котором видно команду и процесс захвата
— файлы pcap.

Решение:
1. 
Запустим команду -
tshark -i any -f "!(icmp)" -w /tmp/hw1.pcap
<image src="hw1.pcap.png">
Значение ключей:
-i any  - указывает на захват трафика со всех интерфейсов.
-f "!(icmp)"  - захватывает все, кроме ICMP трафика.
-w /tmp/hw1.pcap  - указывает путь к файлу с дампом трафика.
Захват шел с сайта mail.ru

2. 
Запустим команду -
tshark -i any -f "host ya.ru" -V -w /tmp/hw2.pcap
<image src="hw2.pcap.png">
<image src="hw2-2.pcap.png">
Значение ключей:
-i any - указывает на захват трафика со всех интерфейсов.
-f " host ya.ru " - задает фильтр для захвата трафика только с ya.ru.
-V – ключ для вывода детальной информации в терминал.
-w /tmp/hw2.pcap - указывает путь к файлу с дампом трафика.

3.
Запустим команду -
sudo tshark -i any -f "tcp dst port 22" -w /tmp/hw3.pcap
<image src="hw3.pcap.png">

Значение ключей:
-i  - указывает на захват трафика со всех интерфейсов.
-f " tcp dst port 22"  - задает фильтр для включения исходящего трафика на
22 порт.
-w /tmp/hw3.pcap указывает путь к файлу с дампом трафика.
Затем подключимся к виртуалке с реальной машиной и, после окончания ssh-сеанса, созраним трафик.
<image src="ssh_connect.png">

Файлы дампов трафика прилагаются.
